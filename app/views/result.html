<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" type="text/css" href="/stylesheet/result.css">
    <title>result</title>

    <script src="/js/func.js"></script>
    <script type="text/javascript" src="/socket.io/socket.io.js"></script>
</head>

<body>
    <h1 align="center">結果画面</h1>
    <table height=400px>
        <tr>
            <td width=700px height=400px bgcolor=white>
                <div id="tab-wrap">
                    <!--ここにタブ切り替えで複数のソースコードが表示される-->
                </div>
            </td>
            <td width=400px height=400px bgcolor=white>
                <p>input</p>
                <textarea height=100px id="input" bgcolor=gray></textarea>
                <p>output ※コンパイルに2秒程かかります。</p>
                <div style="white-space: pre-line" height=220px id="output" bgcolor=gray></div>

            </td>
            <input type=button onclick="run()" value="RUN">
            <input type=button onclick="stop()" value="STOP">
        </tr>
    </table>


    <script type="text/javascript">
        const socket = io("/end");
        let num = 0;
        let sources = [];

        function run() {
            const radio = document.getElementsByName('TAB');
            const input = document.getElementById("input").value;
            for (let i = 0; i < num; i++) {
                if (radio.item(i).checked) {
                    compile(sources[i], input);
                }
            }
        };

        socket.on("result", function (data) {
            num = data.length;
            sources = data.concat();
            const content = document.getElementById('tab-wrap');
            let temp = '<input id="TAB-1" type="radio" name="TAB" class="tab-switch" checked="checked" /><label class="tab-label" for="TAB-1">code1</label><div class="tab-content"><pre><code>' + data[0] + '</code></pre></div>';
            content.insertAdjacentHTML('afterbegin', temp);

            for (let i = 1; i < data.length; i++) {
                temp = '<input id="TAB-' + (i + 1) + '" type="radio" name="TAB" class="tab-switch" /><label class="tab-label" for="TAB-' + (i + 1) + '">code' + (i + 1) + '</label><div class="tab-content"><pre><code>' + data[i] + '</code></pre></div>';
                content.insertAdjacentHTML('beforeend', temp);
            }
        });
    </script>
</body>

</html>